<!doctype html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>AMW Ice and Water Vending</title>
    <link rel="icon" type="image/x-icon" href="https://img5.pic.in.th/file/secure-sv1/PP489c54a4cbfd71b0.png">
    <style>
        body {
            margin: 0;
            padding: 0;
            overflow: hidden; /* Prevent scrollbars on the main page */
            height: 100vh; /* Ensure body takes full viewport height */
            width: 100vw; /* Ensure body takes full viewport width */
        }
        /* Style for the iframe to ensure it fills the parent container */
        #myWebAppIframe {
            display: block; /* Remove extra space below iframe */
            width: 100%;
            height: 100%;
            border: 0; /* Remove default iframe border */
        }
    </style>
</head>
<body>
    <!-- Iframe to embed the Google Apps Script Web App -->
    <iframe
        id="myWebAppIframe"
        src="https://script.google.com/macros/s/AKfycbwUMyOpIw6nY9vtTNXfYW-cW38fxQLrmh1jjlQHLbvt7wnou1wtqOkqs16vmpbz2x4PQg/exec"
        title="AMW Ice and Water Vending Web App"
        frameborder="0"
    >
        <!-- Fallback message if the browser does not support iframes -->
        <p>เบราว์เซอร์ของคุณไม่รองรับ iframe หรือไม่สามารถโหลดเว็บแอปได้ กรุณาเข้าชม <a href="https://script.google.com/macros/s/AKfycbwUMyOpIw6nY9vtTNXfYW-cW38fxQLrmh1jjlQHLbvt7wnou1wtqOkqs16vmpbz2x4PQg/exec" target="_blank">เว็บแอป Amw Ice and Water Vending โดยตรงที่นี่</a></p>
    </iframe>

    <script>
        const iframe = document.getElementById('myWebAppIframe');
        const refreshInterval = 5 * 60 * 1000; // 5 minutes in milliseconds

        // Function to refresh the iframe
        function refreshIframe() {
            // Reload the iframe by setting its src to the current value
            // This effectively reloads the content within the iframe
            iframe.src = iframe.src;
            console.log('Web app refreshed at:', new Date().toLocaleTimeString());
        }

        // Start the automatic refresh interval when the window loads
        window.onload = function() {
            setInterval(refreshIframe, refreshInterval);
            console.log('Automatic refresh set for every 5 minutes.');
        };

        // IMPORTANT: If you encounter "script.google.com ปฏิเสธการเชื่อมต่อ" (X-Frame-Options)
        // You must modify your Google Apps Script's doGet(e) function to allow embedding:
        // For example:
        // function doGet(e) {
        //   return HtmlService.createHtmlOutputFromFile('YourHtmlFileName')
        //       .setXFrameOptionsMode(HtmlService.XFrameOptionsMode.ALLOWALL);
        // }
    </script>
</body>
</html>
